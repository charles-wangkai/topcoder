import java.util.ArrayList;
import java.util.List;
import java.util.stream.IntStream;

public class Centipede {
  public String[] simulate(String[] screenLayout, int timeUnits) {
    int row = screenLayout.length;
    int col = screenLayout[0].length();

    List<State> states = new ArrayList<>();
    int r = 0;
    int c = 1;
    int dc = 1;
    while (r != row) {
      states.add(new State(r, c, dc));

      if (screenLayout[r].charAt(c + dc) == '#') {
        if (r == row - 1 || screenLayout[r + 1].charAt(c) == ' ') {
          ++r;
        }

        dc *= -1;
      } else {
        c += dc;
      }
    }

    char[][] cells = new char[row][col];
    for (int i = 0; i < row; ++i) {
      for (int j = 0; j < col; ++j) {
        cells[i][j] = screenLayout[i].charAt(j);
      }
    }

    int index = timeUnits % states.size();
    for (int i = 0; i < 10 && index < states.size(); ++i) {
      cells[states.get(index).r][states.get(index).c] = 'x';
      ++index;
    }

    return IntStream.range(0, row).mapToObj(i -> new String(cells[i])).toArray(String[]::new);
  }

  class State {
    int r;
    int c;
    int dc;

    State(int r, int c, int dc) {
      this.r = r;
      this.c = c;
      this.dc = dc;
    }
  }

  // BEGIN KAWIGIEDIT TESTING
  // Generated by KawigiEdit 2.1.4 (beta) modified by pivanof
  private static boolean KawigiEdit_RunTest(
      int testNum, String[] p0, int p1, boolean hasAnswer, String[] p2) {
    System.out.print("Test " + testNum + ": [" + "{");
    for (int i = 0; p0.length > i; ++i) {
      if (i > 0) {
        System.out.print(",");
      }
      System.out.print("\"" + p0[i] + "\"");
    }
    System.out.print("}" + "," + p1);
    System.out.println("]");
    Centipede obj;
    String[] answer;
    obj = new Centipede();
    long startTime = System.currentTimeMillis();
    answer = obj.simulate(p0, p1);
    long endTime = System.currentTimeMillis();
    boolean res;
    res = true;
    System.out.println("Time: " + (endTime - startTime) / 1000.0 + " seconds");
    if (hasAnswer) {
      System.out.println("Desired answer:");
      System.out.print("\t" + "{");
      for (int i = 0; p2.length > i; ++i) {
        if (i > 0) {
          System.out.print(",");
        }
        System.out.print("\"" + p2[i] + "\"");
      }
      System.out.println("}");
    }
    System.out.println("Your answer:");
    System.out.print("\t" + "{");
    for (int i = 0; answer.length > i; ++i) {
      if (i > 0) {
        System.out.print(",");
      }
      System.out.print("\"" + answer[i] + "\"");
    }
    System.out.println("}");
    if (hasAnswer) {
      if (answer.length != p2.length) {
        res = false;
      } else {
        for (int i = 0; answer.length > i; ++i) {
          if (!answer[i].equals(p2[i])) {
            res = false;
          }
        }
      }
    }
    if (!res) {
      System.out.println("DOESN'T MATCH!!!!");
    } else if ((endTime - startTime) / 1000.0 >= 2) {
      System.out.println("FAIL the timeout");
      res = false;
    } else if (hasAnswer) {
      System.out.println("Match :-)");
    } else {
      System.out.println("OK, but is it right?");
    }
    System.out.println("");
    return res;
  }

  public static void main(String[] args) {
    boolean all_right;
    all_right = true;

    String[] p0;
    int p1;
    String[] p2;

    // ----- test 0 -----
    p0 =
        new String[] {
          "#                #",
          "# #      #       #",
          "#   #    #   #   #",
          "#           #    #",
          "#   ##         # #",
          "# #      ##      #",
          "#    #           #",
          "#                #"
        };
    p1 = 24;
    p2 =
        new String[] {
          "#                #",
          "# #      #       #",
          "#   #    #xxx#   #",
          "#         xx#    #",
          "#   ##   xxx   # #",
          "# #      ##      #",
          "#    #           #",
          "#                #"
        };
    all_right = KawigiEdit_RunTest(0, p0, p1, true, p2) && all_right;
    // ------------------

    // ----- test 1 -----
    p0 = new String[] {"#          #", "#          #"};
    p1 = 16;
    p2 = new String[] {"#          #", "#xxxx      #"};
    all_right = KawigiEdit_RunTest(1, p0, p1, true, p2) && all_right;
    // ------------------

    // ----- test 2 -----
    p0 = new String[] {"#            #", "#     #      #", "#            #"};
    p1 = 24;
    p2 = new String[] {"#xxxxxxxxxx  #", "#     #      #", "#            #"};
    all_right = KawigiEdit_RunTest(2, p0, p1, true, p2) && all_right;
    // ------------------

    // ----- test 3 -----
    p0 =
        new String[] {
          "#                        #",
          "#      #                 #",
          "#                 #      #",
          "#  ##    #               #",
          "#              #    #    #",
          "#     #                  #",
          "#       #          #     #",
          "#          #             #",
          "#              #         #"
        };
    p1 = 74607;
    p2 =
        new String[] {
          "#                        #",
          "#      #                 #",
          "#                 #      #",
          "#  ##    #               #",
          "#              #    #    #",
          "#     #xxxxxxx           #",
          "#      x#          #     #",
          "#     xx   #             #",
          "#              #         #"
        };
    all_right = KawigiEdit_RunTest(3, p0, p1, true, p2) && all_right;
    // ------------------

    // ----- test 4 -----
    p0 =
        new String[] {
          "#                            #",
          "#   #     # # #           # ##",
          "#   #       #                #",
          "#                          # #",
          "#                   #        #",
          "##    #           #        # #",
          "#    #    #   #              #",
          "#  #    #  #          #      #",
          "#     #   #       #          #",
          "#                            #",
          "#     #        #         #   #",
          "#   ###          #        #  #",
          "#           ##             # #",
          "#                     #      #",
          "##           #               #",
          "#     #     #   #     # #    #",
          "#          #  ##   #         #",
          "#                    #       #",
          "#                    #  #    #"
        };
    p1 = 598273167;
    p2 =
        new String[] {
          "#                            #",
          "#   #     # # #           # ##",
          "#   #       #                #",
          "#                          # #",
          "#                   #        #",
          "##    #           #        # #",
          "#    #    #   #              #",
          "#  #    #  #          #      #",
          "#     #   #       #          #",
          "#                         xxx#",
          "#     #        #         #xxx#",
          "#   ###          #        # x#",
          "#           ##             # #",
          "#                     #      #",
          "##           #               #",
          "#     #     #   #     # #    #",
          "#          #  ##   #         #",
          "#                    #       #",
          "#                    #  #    #"
        };
    all_right = KawigiEdit_RunTest(4, p0, p1, true, p2) && all_right;
    // ------------------

    if (all_right) {
      System.out.println("You're a stud (at least on the example cases)!");
    } else {
      System.out.println("Some of the test cases had errors.");
    }
  }
  // END KAWIGIEDIT TESTING
}
// Powered by KawigiEdit 2.1.4 (beta) modified by pivanof!
